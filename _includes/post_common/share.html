{%-comment-%}
  Mr. Green Jekyll Theme (https://github.com/MrGreensWorkshop/MrGreen-JekyllTheme)
  Copyright (c) 2022 Mr. Green's Workshop https://www.MrGreensWorkshop.com
  Licensed under MIT
{%-endcomment-%}

{%comment-%} Post share links {%-endcomment-%}

{%- capture page_title -%} {{ include.title }} - {{ site.data.owner[lng].brand }} {%- endcapture %}
{%- assign page_title = page_title | uri_escape -%}
{%- assign page_url = include.url | absolute_url | url_encode -%}
{%- if site.data.conf.posts.share_buttons_hover_effect -%}
  {%- capture effect_share_button -%}
    class="{{ site.data.conf.posts.share_buttons_hover_effect }}"
  {%- endcapture %}
{%- endif -%}
<hr>
<div class="share-holder">
  <span class="share-label">{{ site.data.lang[lng].post.share.heading }}: </span>
  <ul class="share-buttons">
    {% for share_const in site.data.const.share -%}
      {% assign share_key = share_const | first | first -%}
      {%- assign tag_url = share_const.url | replace: '{text}', page_title | replace: '{title}', page_title | replace: '{url}', page_url | escape_once -%}
      {%- capture tag_attr -%} target="_blank" rel="noopener noreferrer" {%- endcapture -%}


      {%- assign icon_first_chr = nil -%}
      {%- assign share_icon_tag = nil -%}
      {%- assign icon_first_chr = share_const.icon | slice: 0 -%}
      {%- if share_const.icon contains 'http://' or share_const.icon contains 'https://' or icon_first_chr == '/' %}
        {%- capture share_icon_tag -%} <img src="{{ share_const.icon }}" alt="{{ account_key }}"/> {%- endcapture %}
      {% else %}
        {%- capture share_icon_tag -%} <i class="{{ share_const.icon }}" aria-hidden="true"></i> {%- endcapture %}
      {% endif -%}


      {%- if share_key == "copy_link" -%}
        {%- assign tag_url = 'javascript:void(0);' -%}
        {%- capture tag_attr -%}
          onclick="copyToClipboard('{{ include.url | absolute_url }}', '{{ site.data.lang[lng].post.share.link_copied }}')" id="copytoclipboard"
        {%- endcapture -%}
      {% endif -%}


      {%- if site.data.conf.posts.share_buttons_tooltip -%}
        {%- capture tooltip_share_buttons -%}
          data-toggle="tooltip" data-placement="top" title="{{ site.data.lang[lng].post.share.tooltip[share_key] }}"
        {%- endcapture %}
      {%- endif %}
      <li>
        <a href="{{ tag_url }}" aria-label="{{ site.data.lang[lng].post.share.tooltip[share_key] }}" role="button" {{ tag_attr }} {{ tooltip_share_buttons }} {{ effect_share_button }}>{{ contact_icon_tag }}
        </a>
      </li>
    {% endfor %}
  </ul>
</div>
